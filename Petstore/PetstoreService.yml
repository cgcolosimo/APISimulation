schema: SimV1
name: Swagger Petstore

connections:
  - name: petCon
    port: 23432

  - name: realPetstoreEndpoint
    endpoint: https://petstore.swagger.io/v2/
    listen: false

services:

- name: /v2/pet - POST - addPet
  steps:
  - name: add pet request
    direction: In
    from: petCon
    trigger:
    - type: Path
      value: /v2/pet
    - property: Method
      value: POST
    buffer:
    - jsonPath: name 
      name: petName
  - name: add pet response
    message:
      payload: >-
          {
            "id": 0,
            "category": {
              "id": 0,
              "name": "string"
            },
            "name": "doggie",
            "photoUrls": [
              "string"
            ],
            "tags": [
              {
                "id": 0,
                "name": "string"
              }
            ],
            "status": "available"
          }
      statusCode: 200
    insert:
      - jsonPath: id
        value: "{RND[4]}"
      - jsonPath: name
        value: "{B[petName]}"
        
- name: /v2/pet - GET - findByStatus
  steps:
  - name: find pet request
    direction: In
    from: petCon
    trigger:
    - type: Path
      value: /v2/pet/findByStatus
    - property: Method
      value: GET
    buffer:
    - type: Query
      key: status
      name: petStatus
  - name: find pet response
    message:
      statusCode: 200
    insert:
      - file: "./Petstore/petData/{B[petStatus]}.json"